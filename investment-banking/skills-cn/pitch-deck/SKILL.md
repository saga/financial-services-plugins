---
name: pitch-deck
description: 使用源文件数据填充投资银行推介材料模板。适用于：用户提供PowerPoint模板需要填充、用户有源数据（Excel/CSV）需要填充到幻灯片、用户提到填充推介材料模板、或用户需要将数据传输到现有幻灯片布局。不适用于从头创建演示文稿。
---

# 投资银行推介材料模板填充

## 参考文件

**开始任何工作前先阅读所有参考文件。** 这些包含会影响您方法的关键模式和反模式。

| 文件 | 用途 |
|------|------|
| `formatting-standards.md` | 文本、要点、表格、图表、对齐 |
| `slide-templates.md` | 常见幻灯片类型的内容映射指南 |
| `xml-reference.md` | 表格、形状、箭头的PowerPoint XML模式 |
| `calculation-standards.md` | 用于验证的财务公式（CAGR、共识） |

---

## 工作流程决策树

**这是什么类型的任务？**

```
┌─ 用源数据填充空白模板？
│  └─→ 遵循下方"模板填充工作流程"
│
├─ 编辑已填充的现有幻灯片？
│  └─→ 提取当前内容、修改、重新验证
│
└─ 修复现有幻灯片的格式问题？
   └─→ 参见"常见失败"表格，应用针对性修复
```

---

## 关键渲染限制

**LibreOffice用于验证但无法准确渲染PowerPoint文件。** 它会破坏字体、渐变、形状位置、文本换行和某些表格格式。

**这意味着：** 在LibreOffice中通过视觉验证的幻灯片在Microsoft PowerPoint中可能仍有问题。

**必需操作：** 交付输出时始终包含此声明：
> "此文件使用LibreOffice验证。请在分发前在Microsoft PowerPoint中审阅，因为可能存在渲染差异。"

---

## 模板填充工作流程

复制并跟踪进度：

```
推介材料进度：
- [ ] 阶段1：提取并验证源数据
- [ ] 阶段2：将内容映射到模板部分
- [ ] 阶段3：用正确格式填充幻灯片
- [ ] 阶段4：验证 → 修复 → 重复直到干净
- [ ] 阶段5：最终验证
```

### 阶段1：数据提取
1. **创建备份** — 修改前复制原始模板到 `[文件名]_backup.pptx`
2. 识别所有源材料（Excel、CSV、PDF报告、Word文档、数据库、网络来源）
3. 从每个来源提取相关数据点
4. 根据原始来源验证所有数字
5. 标准化单位和货币
6. 注明任何需要验证的计算

### 阶段2：内容映射
1. **打开并视觉审查模板** — 修改前了解其结构、风格和现有内容
2. 分析模板结构 — 识别所有占位符区域和内容框
3. 将源数据映射到对应的模板部分
4. 识别占位符指导框（任务创建者的彩色说明框）
5. 注明任何数据缺口或不匹配

### 阶段3：模板填充
1. **移除或重新格式化占位符框** — 彩色说明框展示要创建什么，而非如何格式化
2. 用映射内容填充每个部分（先关注内容）
3. **然后应用格式** 匹配模板风格
4. 创建实际表格对象（绝不使用管道符/制表符分隔的文本）
5. 创建PowerPoint对象的箭头/形状
6. 如任务文件中提供了公司Logo则插入

### 阶段4：验证 → 修复 → 重复

```bash
soffice --headless --convert-to pdf presentation.pptx
pdftoppm -jpeg -r 150 presentation.pdf slide
```

**验证清单（检查每张幻灯片图像）：**
- [ ] 文本在背景上可读？
- [ ] 表格是实际对象？
- [ ] 图表/表格填满指定区域？
- [ ] 各部分内要点格式一致？
- [ ] 同级框字体大小匹配？
- [ ] 无内容超出幻灯片边界？
- [ ] 无保留的占位符格式？
- [ ] 无基于文本的"表格"？
- [ ] 跨幻灯片一致性？

**修复循环协议：**

| 循环 | 行动 |
|------|------|
| 1 | 修复所有识别的问题，重新验证 |
| 2 | 修复剩余问题，重新验证 |
| 3 | 如问题持续，记录剩余问题并升级给用户 |

### 阶段5：最终验证

交付前运行[最终质量清单](#最终质量清单)。

---

## 快速参考表格

### 要点符号

| 上下文 | 符号 | 用途 |
|--------|------|------|
| 包含/正面 | ✓ | 范围内项目、存在的功能 |
| 排除/负面 | × | 范围外项目、缺失的功能 |
| 中性列表 | • | 一般枚举、评论 |
| 编号序列 | 1. 2. 3. | 流程步骤、排名 |
| 子要点 | – | 主要点下的次要点 |

### 字体一致性匹配

**同一层级级别**的框必须使用相同的字体大小：

| 同级 | 必须匹配 |
|------|----------|
| "包含分部" | "排除分部" |
| "定义" | "范围理由" |
| 左列要点 | 右列要点 |

### 演示用舍入

| 值类型 | 典型舍入 | 示例 |
|--------|----------|------|
| 大市场规模（$10bn+） | 最近$1bn | 18.5 → $19bn |
| 较小市场规模（<$10bn） | 最近$0.5bn | 2.3 → $2.5bn |
| CAGR | 整数%或0.5% | 16.4% → 16%或16.5% |
| 市场份额 | 最近5% | 21.4% → 20% |
| 倍数 | 1位小数 | 9.69 → 9.7x |

---

## 必须要求

无论模板如何，这些要求都是不可协商的：

| 要求 | 详情 |
|------|------|
| **文本可读性** | 所有文本必须与背景有足够对比度 |
| **实际表格对象** | 表格数据必须是表格对象，而非制表符分隔的文本 |
| **正确的图表/表格大小** | 粘贴的视觉元素必须填满指定区域 |
| **一致的格式** | 部分内的要点必须匹配 |
| **内容边界** | 所有内容必须保持在幻灯片边缘内 |
| **无占位符格式** | 移除彩色说明框 |

---

## 关键反模式：永远不要这样做

### 反模式1：将数据填充到占位符框中

**发生什么：** 模板有彩色说明框包含指导文本。模型用实际数据替换指导文本但保留彩色框。

**为什么错误：** 彩色框就是占位符。输出应该有不同的格式。

**关键区分：**

| 类型 | 如何识别 | 做什么 |
|------|----------|--------|
| **说明框** | 鲜艳颜色，包含指导文本 | 删除整个形状，创建新内容 |
| **布局占位符** | 匹配模板主题的中性颜色 | 保留形状，仅替换文本内容 |

### 反模式2：基于文本的"表格"

**发生什么：** 模型使用分隔符（`|`、制表符）而非实际表格对象创建类似表格的内容。

**为什么错误：** 这不是表格。列永远不会正确对齐。

### 反模式3：继承占位符对比度

**发生什么：** 占位符使用彩色背景上的浅色文本。模型填充数据但保留此配色方案。

**正确方法：** 主体内容通常为浅色背景上的深色文本。

---

## 常见失败

| 失败 | 解决方案 |
|------|----------|
| 非结构化文本堆 | 分解为要点（✓, ×, •） |
| 管道符分隔的"表格" | 创建实际表格对象 |
| 文本/背景对比度差 | 审查每个文本元素 |
| 粘贴的图表太小 | 调整大小以填满区域 |
| 内容溢出 | 设置明确的框宽度 |

---

## 最终质量清单

### 数据准确性
- [ ] 所有数字与原始源文件匹配
- [ ] 计算值根据公式验证
- [ ] 相同数字在所有出现的幻灯片上完全相同

### 内容映射
- [ ] 每个模板部分填充了适当的数据
- [ ] 无剩余的`[括号]`占位符文本
- [ ] 所有来源引用包含在脚注中

### 格式
- [ ] 文本在所有背景上可读
- [ ] 表格是实际表格对象
- [ ] 图表/表格填满指定区域
- [ ] 要点格式一致
- [ ] 无内容超出幻灯片边界

### 最终步骤
- [ ] 建议用户在分发前在Microsoft PowerPoint中验证
