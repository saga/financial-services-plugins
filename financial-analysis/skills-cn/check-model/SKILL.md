---
name: check-model-cn
description: 调试和审计财务模型中的错误——循环引用、公式失效、硬编码覆盖、资产负债表失衡、现金流量不勾稽、逻辑漏洞。当模型无法平衡、产生意外结果、或在发送给客户/投资委员会前需要检查时使用。触发词包括："调试模型"、"模型检查"、"审计模型"、"模型不平衡"、"模型有问题"、"检查我的模型"、"模型质检"、"模型评审"。
---

# 模型检查器

调试和审计财务模型中的错误——循环引用、公式失效、硬编码覆盖、资产负债表失衡、现金流量不勾稽以及逻辑漏洞。当模型无法平衡、产生意外结果，或在提交给客户或投资委员会前，均可使用本工具。

## 工作流程

### 第一步：获取模型

- 接收用户的 Excel 模型（.xlsx 或 .xlsm）
- 识别模型类型：DCF、LBO、并购、三表联动、可比公司分析、回报分析或自定义
- 梳理结构：存在哪些工作表、如何相互链接、输入与输出分别在哪

### 第二步：结构检查

**工作表与布局审阅：**
- 输入项是否与计算项清晰分离？
- 是否有一致的颜色编码规范？（蓝色=输入，黑色=公式，绿色=跨表链接）
- 是否存在可能含有覆盖项的隐藏工作表或行？
- 模型流向是否合理？（假设 → 利润表 → 资产负债表 → 现金流量表 → 估值）

**公式一致性：**
- 检查公式中的硬编码数字（部分硬编码）
- 检查行/列范围内公式是否不一致（同行公式应为跨列拖拽的相同公式）
- 识别任何 #REF!、#VALUE!、#N/A、#DIV/0! 错误
- 标记格式为公式但实际含有硬编码值的单元格

### 第三步：完整性检查

**资产负债表：**
- 各期间资产 = 负债 + 净资产
- 若不平衡，量化差距并追溯失衡位置
- 检查留存收益是否正确滚动：期初留存 + 净利润 - 股利 = 本期留存
- 验证商誉和无形资产是否从并购假设流入（并购模型适用）

**现金流量表：**
- 各期间现金流量表期末现金 = 资产负债表现金
- 经营活动现金流 + 投资活动现金流 + 融资活动现金流 = 现金变动额
- 现金流量表折旧摊销与利润表匹配
- 现金流量表资本开支与资产负债表 PP&E 滚动表匹配
- 现金流量表营运资本变化与资产负债表变动（应收账款、应付账款、存货）匹配

**利润表：**
- 营收拆解与分部/产品明细勾稽
- 营业成本和毛利率与假设一致
- 所得税费用 = 税前利润 × 税率（检查递延所得税调整）
- 股数与稀释方案勾稽（期权、可转债、回购）

**循环引用：**
- 检查循环引用（利息支出 → 债务余额 → 现金 → 利息）
- 若为有意为之（LBO/三表联动模型中常见），验证迭代开关是否正常工作
- 若为无意引入，追踪循环路径并提出打破循环的方案

### 第四步：逻辑检查

**合理性验证：**
- 增长率是否合理？（无解释的100%+营收增长 = 红色预警）
- 利润率是否在行业正常范围内？标记异常值
- DCF 中终端价值是否占主导？（超过75%的企业价值来自终端价值为黄色预警）
- 预测是否存在不现实的"曲棍球棒"形态？
- 第10年时 EBITDA 复合增长是否达到荒谬的数字？

**敏感性与边界情况：**
- 零增长时会发生什么？负增长时呢？
- EBITDA 为负时模型会崩溃吗？
- 杠杆率是否会变为负数或超出现实界限？
- 是否存在零除风险？

**跨工作表一致性：**
- 被链接的单元格是否确实与来源匹配？（复制粘贴错误很常见）
- 所有工作表的日期标题是否一致？
- 单位是否匹配（千元 vs 百万元 vs 实际值）？

### 第五步：按模型类型检查常见问题

**DCF 模型：**
- 折现率适用期间错误（年中惯例 vs 年末惯例）
- 终端价值未正确折现回来
- WACC 使用账面价值而非市场价值
- 自由现金流包含利息支出（应为无杠杆自由现金流）
- 税盾重复计算

**LBO 模型：**
- 还款金额与现金归还机制不匹配
- PIK 利息未计入债务余额
- 管理层跟投未体现在回报中
- 退出倍数适用于错误的 EBITDA（过去十二个月 vs 未来十二个月）
- 交易费用和支出未从第一天股权中扣除

**并购模型：**
- 增厚/摊薄使用了错误的股数（交易前 vs 交易后）
- 协同效应逐步兑现未正确建模
- 购买价格分配不平衡
- 未计入放弃的现金利息
- 交易费用未列入资金来源与用途

**三表联动模型：**
- 营运资本变化符号约定错误
- 折旧与 PP&E 明细表不匹配
- 债务到期明细与本金偿还不匹配
- 无解释地以超过净利润的金额支付股利

### 第六步：出具报告

生成模型审计报告：

**摘要：**
- 模型类型和总体评估（干净 / 有轻微问题 / 有重大问题）
- 按严重程度划分的问题数量

**问题清单：**

| 序号 | 工作表 | 单元格/范围 | 严重程度 | 类别 | 描述 | 建议修复方案 |
|------|--------|------------|----------|------|------|------------|
| 1 | | | 严重/警告/提示 | 公式/逻辑/平衡/硬编码 | | |

**严重程度定义：**
- **严重**：模型输出错误结果（资产负债表不平衡、公式失效）
- **警告**：模型可运行但存在风险（硬编码、公式不一致、边界情况失效）
- **提示**：风格和最佳实践建议（颜色编码、布局、命名）

### 第七步：输出结果

- 问题清单（在对话中或 Excel 文件中）
- 标注了问题单元格的模型（如用户提供了文件）
- 含修复优先级的总体评估

## 重要注意事项

- 始终先检查资产负债表平衡——若不平衡，其他问题暂时可以搁置
- 硬编码覆盖是模型错误的第一大来源——务必积极搜索
- 符号约定错误（现金流出的正负号）极为常见
- "能运行"的模型仍可能是错的——用行业基准对输出结果进行合理性检验
- 若模型使用 VBA 宏，注明任何无法仅通过公式审计的宏驱动计算
- 未经询问不要修改模型——报告问题，由用户决定如何修复
