# DCF模型故障排除指南

**何时阅读此文件：** 如果recalc.py显示错误，或估值结果看起来不合理，或情景选择器无法正常工作。

## 模型返回错误值

### #REF! 错误
- 通常由插入标题行后公式引用错误行导致
- 解决方案：使用正确的行引用重建，或按照布局规划重新开始
- 预防措施：在编写公式前定义所有行位置

### #DIV/0! 错误
- 除以零或空单元格
- 解决方案：添加IF语句处理零值：`=IF([除数]=0,0,[被除数]/[除数])`

### #VALUE! 错误
- 计算中数据类型错误（文本而非数字）
- 解决方案：验证所有输入格式为数字

## 估值看起来不合理

### 隐含股价过高
- 检查终值是否超过企业价值的80%
- 验证终值增长率小于WACC
- 审查增长假设是否现实
- 考虑利润率是否过于乐观

### 隐含股价过低
- 验证净债务vs净现金是否正确
- 检查WACC是否过高
- 审查预测是否过于保守
- 考虑终值增长率是否过低

## 情景选择器无法工作

### 切换情景时合并列不更新
- 验证情景选择器单元格包含1、2或3
- 检查INDEX/OFFSET公式引用正确的行范围和选择器单元格
- 确保选择器使用绝对引用（$B$6）
- 通过手动更改选择器单元格并验证预测值更新来测试
