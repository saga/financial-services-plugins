---
name: 3-statements-cn
description: 完成、填充和整理三表联动财务模型模板（利润表、资产负债表、现金流量表）。当被要求填写模型模板、完善现有模型框架、用数据填充财务模型、补全部分完成的利润表/资产负债表/现金流量表框架，或在现有模板结构内链接三表时使用。触发词包括：填写、完成、填充三表模型模板等。
---

# 三表联动财务模型模板完成指南

在利润表、资产负债表和现金流量表之间建立正确勾稽关系，完成并填充整合型财务模型模板。

## 模型结构

### 识别模板工作表组织

模板的工作表命名和组织方式各有不同。填充前，请先通读所有工作表，了解模板结构。常见工作表名称及内容如下：

| 常见工作表名称 | 内容 |
|----------------|------|
| IS、P&L、利润表 | 利润表 |
| BS、资产负债表 | 资产负债表 |
| CF、CFS、现金流 | 现金流量表 |
| WC、营运资本 | 营运资本明细 |
| DA、D&A、折旧、PP&E | 折旧与摊销明细 |
| 债务、债务明细 | 债务明细表 |
| NOL、税务、DTA | 净经营亏损明细 |
| 假设、输入、驱动因素 | 驱动假设和输入项 |
| 检查、审计、验证 | 错误检查看板 |

**模板审阅清单**
- 确认模板中存在哪些工作表（并非所有模板都包含每个明细表）
- 记录上表未列出的模板特有工作表
- 理解工作表间的依赖关系（例如哪些明细表汇入主表）
- 在每个工作表中定位输入单元格与公式单元格

### 理解模板结构

填充模板前，先熟悉其现有布局，确保数据输入位置正确，且公式不被破坏。

**识别行结构**
- 在每个工作表顶部找到模型标题
- 识别各节标题及其视觉分隔
- 找到单位行（如：百万美元、%、x 等）
- 注意列标题，区分实际值（A）与预测值（E）期间
- 确认期间标签（如：FY2024A、FY2025E）
- 识别输入单元格与公式单元格（通常通过字体颜色区分）

**识别列结构**
- 确认最左列为行项目标签
- 验证历史年份在预测年份之前
- 注意区分历史与预测期间的视觉边框
- 检查所有工作表列顺序是否一致

**使用命名范围**
模板通常对关键输入和输出使用命名范围。输入数据前：
- 查看模板中现有的命名范围（Excel：公式 → 名称管理器）
- 常见命名范围包括：营收增长率、成本占比、关键输出（净利润、EBITDA、总债务、现金）、情景选择单元格
- 确保输入项填写在这些命名范围所引用的单元格中

### 预测期间
- 模板通常从最后一个历史年份起向前预测5年
- 确认历史（A）与预测（E）列清晰分隔
- 确认列使用财政年度标注（如：FY2024A、FY2025E）

## 利润率分析

**注意：以下利润率分析仅在用户明确要求或模板有此要求时执行。如无提示，跳过本节。**

在利润表（IS）工作表上计算并展示盈利率，以追踪运营效率并支持同行比较。

### 核心利润率

| 利润率 | 公式 | 衡量内容 |
|--------|------|----------|
| 毛利率 | 毛利润 / 营业收入 | 定价权、生产效率 |
| EBITDA 利润率 | EBITDA / 营业收入 | 核心运营盈利能力 |
| EBIT 利润率 | EBIT / 营业收入 | 折旧摊销后的运营盈利 |
| 净利润率 | 净利润 / 营业收入 | 最终盈利能力 |

### 利润表中利润率的布局

在每个利润行项目正下方展示利润率百分比：
- 毛利润下方显示毛利率%
- EBIT 下方显示 EBIT 利润率%
- EBITDA 下方显示 EBITDA 利润率%
- 净利润下方显示净利润率%

## 信用指标

**注意：以下信用分析仅在用户明确要求或模板有此要求时执行。如无提示，跳过本节。**

在资产负债表（BS）工作表上计算并展示信用/杠杆指标，以评估财务健康状况、债务承载能力和契约合规情况。

### 核心信用指标

| 指标 | 公式 | 衡量内容 |
|------|------|----------|
| 总债务 / EBITDA | 总债务 / LTM EBITDA | 杠杆倍数 |
| 净债务 / EBITDA | （总债务 - 现金）/ LTM EBITDA | 扣除现金后的净杠杆 |
| 利息覆盖率 | EBITDA / 利息支出 | 偿债能力 |
| 债务 / 总资本 | 总债务 /（总债务 + 净资产） | 资本结构 |
| 债务 / 净资产 | 总债务 / 总净资产 | 财务杠杆 |
| 流动比率 | 流动资产 / 流动负债 | 短期流动性 |
| 速动比率 | （流动资产 - 存货）/ 流动负债 | 即时流动性 |

### 信用指标层级检查

验证乐观情景下信用状况最强：
- 杠杆率：乐观 < 基础 < 悲观（越低越好）
- 覆盖率：乐观 > 基础 > 悲观（越高越好）
- 流动性：乐观 > 基础 > 悲观（越高越好）

### 契约合规追踪

若债务契约已知，添加明确的合规检查，将实际指标与契约阈值进行比较。

## 情景分析（基础 / 乐观 / 悲观）

在假设工作表中使用情景切换开关（下拉菜单），配合 CHOOSE 或 INDEX/MATCH 公式。

| 情景 | 描述 |
|------|------|
| 基础情景 | 管理层指引或市场一致预期 |
| 乐观情景 | 超越指引的增长和利润率扩张 |
| 悲观情景 | 低于趋势的增长和利润率收缩 |

**关键敏感性驱动因素**：营收增长、毛利率、SG&A 占比、DSO/DIO/DPO、资本开支占比、利率、税率。

**情景审计检查**：切换开关对所有报表生效；各情景下资产负债表平衡；现金流量勾稽；层级关系成立（乐观 > 基础 > 悲观，适用于净利润、EBITDA、自由现金流、各项利润率）。

## SEC 申报文件数据提取

若模板特别需要从 SEC 申报文件（10-K、10-Q）提取数据，请参见 [references/sec-filings.md](references/sec-filings.md) 获取详细提取指引。该参考文件仅在使用上市公司监管申报数据填充模板时才需要。

## 完成模型模板

本节提供完成任何三表联动财务模型模板的通用指引，以保护现有公式并确保数据完整性。

### 第一步：分析模板结构

输入任何数据前，请彻底审阅模板以了解其架构：

**区分输入单元格与公式单元格**
- 寻找视觉提示（字体颜色、单元格底纹），区分输入单元格与公式单元格
- 常见约定：蓝色字体 = 输入，黑色字体 = 公式，绿色字体 = 跨表链接
- 使用 Excel 的追踪引用（公式 → 追踪引用单元格）理解单元格关系
- 检查可能控制关键输入的命名范围（公式 → 名称管理器）

**理清模板数据流向**
- 识别哪些工作表向其他工作表传输数据（如：假设 → 利润表 → 资产负债表 → 现金流量表）
- 记录辅助明细表及其与主表的勾稽关系
- 在填充前记录模板的具体行项目和结构

### 第二步：不破坏公式地填入数据

**数据录入黄金法则**

| 规则 | 说明 |
|------|------|
| 仅编辑输入单元格 | 除非有意替换，否则不要覆盖含公式的单元格 |
| 保留单元格引用 | 复制数据时使用选择性粘贴-数值（Ctrl+Shift+V），避免覆盖公式和格式 |
| 匹配模板单位 | 输入数据前确认模板使用千元、百万元还是实际值 |
| 遵守符号约定 | 遵循模板现有的符号约定（如费用为正数或负数） |
| 检查循环引用 | 若模板使用迭代计算，确保已启用"启用迭代计算" |

**安全数据录入流程**
1. 识别专供输入的确切单元格（通常有高亮或标注）
2. 先录入历史数据，验证公式在这些期间正确计算
3. 输入驱动预测计算的假设驱动因素
4. 检查计算结果，确认公式按预期运行
5. 若必须修改公式单元格，在修改前记录原始公式

**处理预置公式**
- 若公式引用了尚未填充的单元格，在所有输入完成前会出现临时错误（#REF!、#DIV/0!）
- 公式产生意外结果时，追踪引用以识别缺失或错误的输入
- 未检查所有工作表的公式依赖关系前，不要删除行/列

### 第三步：验证公式

**公式完整性检查**

在依赖模板输出前，验证公式是否正常运行：

| 检查类型 | 方法 |
|----------|------|
| 追踪引用 | 选中公式单元格 → 公式 → 追踪引用单元格，验证引用了正确的输入 |
| 追踪从属 | 验证关键输入是否流向预期的输出单元格 |
| 公式求值 | 使用公式 → 公式求值，逐步分析复杂计算 |
| 检查硬编码 | 预测公式应引用假设值，不应含有硬编码数字 |
| 用已知值测试 | 输入简单的测试值，验证公式是否产生预期结果 |
| 跨工作表一致性 | 确保相同的公式逻辑适用于所有预测期间 |

**常见公式问题**
- 混用绝对/相对引用导致跨期复制时结果错误
- 外部文件链接失效或范围被删除（#REF! 错误）
- 早期收入未形成规模前出现零除错误（#DIV/0! 错误）
- 循环引用警告（利息计算中可能是有意为之）
- 跨期间公式不一致（使用 Ctrl+\ 找出差异）

**验证跨工作表勾稽**
- 确认在多个工作表出现的数值已通过链接关联（而非重复输入）
- 验证明细表合计与主表对应行项目勾稽
- 检查所有工作表的期间标签是否对齐

### 第四步：按工作表进行质量检查

填充模板后对每个工作表执行以下验证检查：

**利润表（IS）质量检查**
- 历史期间营收数据与来源数据匹配
- 所有费用行项目加总至报告合计
- 小计（毛利润、EBIT、税前利润、净利润）计算正确
- 税额计算逻辑合理（亏损时处理正确）
- 预测驱动因素引用假设工作表（无硬编码）
- 各期间增减变化方向合理

**资产负债表（BS）质量检查**
- 各期间资产 = 负债 + 股东权益（主要检查项）
- 现金余额与现金流量表期末现金匹配
- 营运资本科目与辅助明细表勾稽（如适用）
- 留存收益正确滚动：期初留存 + 净利润 - 股利 +/- 调整 = 期末留存
- 债务余额与债务明细表勾稽（如适用）
- 所有资产负债表项目符号正确（资产为正，大多数负债为正）

**现金流量表（CF）质量检查**
- 经营活动净利润与利润表净利润匹配
- 非现金加回项目（折旧摊销、股权激励等）与来源明细/报表勾稽
- 营运资本变化符号正确（资产增加 = 现金使用 = 负数）
- 资本开支与 PP&E 明细表或固定资产滚动表勾稽
- 融资活动与资产负债表债务和股权科目变化勾稽
- 期末现金与资产负债表现金匹配
- 期初现金等于上期期末现金

**辅助明细表质量检查**
- 期初余额等于上期期末余额
- 滚动逻辑完整（期初 + 增加 - 减少 = 期末）
- 明细表合计与主表行项目勾稽
- 计算中使用的假设与假设工作表一致

### 第五步：跨报表完整性检查

验证各单独工作表后，确认三表已正确整合：

| 检查项 | 公式 | 预期结果 |
|--------|------|----------|
| 资产负债表平衡 | 资产 - 负债 - 净资产 | = 0 |
| 现金流量勾稽 | 现金流量表期末现金 - 资产负债表现金 | = 0 |
| 净利润链接 | 利润表净利润 - 现金流量表起始净利润 | = 0 |
| 留存收益 | 期初留存 + 净利润 - 股利 - 资产负债表期末留存 | = 0（根据需要调整股权激励等项目） |

### 第六步：最终审阅

在认定模型完成前：
- 切换所有情景（如适用），验证各情景下检查项均通过
- 检查所有 #REF!、#DIV/0!、#VALUE!、#NAME? 错误并解决或记录
- 确认所有输入单元格已填写（搜索占位符数值）
- 验证所有工作表单位一致
- 在进行任何其他修改前保存干净版本

## 模型验证与审计

本节汇总了已完成模板的所有验证检查和审计程序。

### 核心勾稽关系（必须始终成立）

所有公式详情参见 [references/formulas.md](references/formulas.md)。

| 检查项 | 公式 | 预期结果 |
|--------|------|----------|
| 资产负债表平衡 | 资产 - 负债 - 净资产 | = 0 |
| 现金流量勾稽 | 现金流量表期末现金 - 资产负债表现金 | = 0 |
| 月度与年度现金 | 月度期末现金 - 年度期末现金 | = 0 |
| 净利润链接 | 利润表净利润 - 现金流量表起始净利润 | = 0 |
| 留存收益 | 期初留存 + 净利润 + 股权激励 - 股利 - 资产负债表期末留存 | = 0 |
| 股权融资 | 资产负债表普通股/资本公积变化 - 现金流量表股权发行 | = 0 |
| 第0年股权 | 第0年募股资金 - 第1年期初股权资本 | = 0 |

### 符号约定参考

| 报表 | 项目 | 符号约定 |
|------|------|----------|
| 经营活动现金流 | 折旧摊销、股权激励 | 正数（加回） |
| 经营活动现金流 | 应收账款增加 | 负数（现金使用） |
| 经营活动现金流 | 应付账款增加 | 正数（现金来源） |
| 投资活动现金流 | 资本开支 | 负数 |
| 融资活动现金流 | 发债 | 正数 |
| 融资活动现金流 | 还债 | 负数 |
| 融资活动现金流 | 股利 | 负数 |

### 循环引用处理

利息支出造成循环：利息 → 净利润 → 现金 → 债务余额 → 利息

在 Excel 中启用迭代计算：文件 → 选项 → 公式 → 启用迭代计算。设置最大迭代次数为 100，最大误差为 0.001。在假设工作表添加断路开关。

### 检查类别

**第1节：货币一致性**
- 货币已在假设工作表中标识和记录
- 所有工作表使用一致的货币符号和量级
- 单位行与模型货币匹配

**第2节：资产负债表完整性**
- 各期间资产 = 负债 + 净资产
- 公式：资产 - 负债 - 净资产（必须 = 0）

**第3节：现金流量完整性**
- 现金与资产负债表勾稽（现金流量表期末现金 = 资产负债表现金）
- 月度与年度现金：月度期末现金 = 年度期末现金
- 净利润与利润表勾稽（现金流量表净利润 = 利润表净利润）
- 折旧摊销与明细表勾稽
- 股权激励与利润表勾稽
- 应收账款、存货、应付账款变化与营运资本明细表勾稽
- 资本开支与折旧摊销明细表勾稽

**第4节：留存收益**
- 留存收益滚动检查：期初留存 + 净利润 + 股权激励 - 股利 = 期末留存
- 展示组成明细以便调试

**第5节：营运资本**
- 应收账款、存货、应付账款与资产负债表勾稽
- DSO、DIO、DPO 合理性检查（超出正常范围则标记）

**第6节：债务明细**
- 总债务与资产负债表勾稽（流动 + 长期债务）
- 利息计算与利润表勾稽

**第6b节：股权融资**
- 股权发行所得与资产负债表普通股/资本公积增加勾稽
- 股权融资产生的现金增加 = 股权科目增加（必须平衡）
- 股权募集勾稽：资产负债表普通股/资本公积变化 = 现金流量表股权发行（必须 = 0）
- 第0年股权勾稽：第0年募股资金 = 第1年期初股权资本

**第6c节：净经营亏损明细**
- 第1年/成立年期初 NOL = 0（新企业从零 NOL 开始）
- NOL 仅在 EBT < 0 时增加（必须实现亏损才能产生 NOL）
- 递延所得税资产与资产负债表勾稽（NOL 明细递延所得税 = 资产负债表递延所得税资产）
- NOL 使用量 ≤ EBT 的 80%（2017年后联邦限制）
- NOL 余额不为负（使用量不能超过可用余额）
- 仅在 EBT < 0 时产生 NOL
- 应税收入 ≤ 0 时，所得税费用 = 0

**第7节：情景层级**
- 绝对指标：乐观 > 基础 > 悲观（净利润、EBITDA、自由现金流）
- 利润率：乐观 > 基础 > 悲观（毛利率%、EBITDA%、净利润%）
- 信用指标：杠杆率情景层级倒置（乐观 < 基础 < 悲观）

**第8节：公式完整性**
- 营业成本、销售费用、管理费用、研发费用、股权激励以营业收入占比驱动（无硬编码）
- 各预测年度公式一致
- 无 #REF!、#DIV/0!、#VALUE! 错误

**第9节：信用指标阈值**
- 根据契约阈值将指标标记为绿/黄/红
- 汇总任何红色预警

### 总检查公式

将所有节的状态汇总为单一总检查：
- 若所有节通过 → "✓ 所有检查已通过"
- 若任意节失败 → "✗ 发现错误 - 请查看以下内容"

### 快速调试流程

当总状态显示错误时：
1. 滚动查找红色高亮节
2. 识别哪个检查类别存在失败
3. 导航至来源工作表进行排查
4. 修复根本问题
5. 返回检查工作表验证问题已解决
