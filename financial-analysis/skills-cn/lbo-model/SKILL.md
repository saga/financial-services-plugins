---
name: lbo-model-cn
description: 本技能用于在私募股权交易、交易材料或投资委员会演示文稿中完成 Excel LBO（杠杆收购）模型模板。该技能负责填充公式、验证计算并确保符合专业格式标准，能够适配任何模板结构。
---

## 模板要求

**本技能基于模板操作。请始终先检查是否附带了模板文件。**

1. **若提供了模板文件**：必须严格遵守该模板的结构——复制该文件并填入用户数据。
2. **若未提供模板**：询问用户：“您是否有特定的 LBO 模板？如果没有，我可以使用包含资金来源与用途 (Sources & Uses)、运营模型、债务明细和回报分析的标准模板。”
3. **默认模板**：使用 `examples/LBO_Model.xlsx` 作为起点。

**重要提示**：禁止在已提供模板的情况下“从零开始”构建模型。即使模板复杂，也应在其基础上进行适配。

---

## 核心原则

*   **全部使用公式**：严禁在 Python 中计算结果后硬编码到单元格。模型必须是动态的。
*   **遵守颜色规范**：
    *   **蓝色 (0000FF)**：硬编码输入。
    *   **黑色 (000000)**：计算公式（含运算符或函数）。
    *   **紫色 (800080)**：同工作表链接（直接引用，无计算）。
    *   **绿色 (008000)**：跨工作表链接。
*   **格式标准**：
    *   金额：`$#,##0`
    *   倍数：`0.0"x"`
    *   回报指标 (MOIC)：`0.00"x"` (保留两位小数)
    *   所有数字右对齐。

---

## 关键计算领域

### 1. 资金来源与用途 (Sources & Uses)
*   **平衡检查**：Sources 必须等于 Uses。通常选择一项（如“所需股权注入”）作为配平项（Plug），通过差额计算得出。

### 2. 税务计算
*   公式应仅引用相关的收入行和税率，不应引用无关部分（如债务计划表）。

### 3. 利息与循环引用
*   为避免死循环，利息计算应基于**期初余额**（Beginning Balance），而非平均或期末余额。

### 4. 债务偿还 / 现金清扫 (Cash Sweeps)
*   遵循还款优先级顺序（Senior Debt > Mezzanine 等）。
*   使用 `MAX(0, ...)` 或 `MIN` 函数确保债务余额不会变为负数。

### 5. 回报计算 (IRR/MOIC)
*   **符号约定**：投资额为负，回收款为正。
*   MOIC = 总回收款 / 总投资额。

### 6. 敏感性分析表
*   每个单元格必须显示**不同**的数值。如果全部相同，说明公式未正确关联行列标题。
*   使用混合引用（如 `$A5` 引用行输入，`B$4` 引用列输入）。

---

## 完成后验证清单

- [ ] **运行重算脚本**：`python recalc.py model.xlsx` 必须返回零错误。
- [ ] **配平检查**：Sources = Uses，资产 = 负债 + 权益。
- [ ] **债务余额**：期末余额不为负。
- [ ] **勾稽关系**：折旧与 PP&E 明细一致，净利润流入现金流量表。
- [ ] **格式检查**：输入项为蓝色，公式为黑色，链接为紫色/绿色。

---

**本技能旨在通过填充正确公式和规范格式，生成投行品质的 LBO 模型。**
